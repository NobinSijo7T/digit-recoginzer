<html>

<head>
  <title>Digit Recognition Web App</title>

  <meta name="viewport" content="width=device-width">
  <!-- GoogleFont: Aldrich for headings, Michroma for content -->
  <link href="https://fonts.googleapis.com/css2?family=Aldrich&family=Michroma&display=swap" rel="stylesheet">
  <!-- Favicon (inline SVG data URI) -->
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='64' height='64' viewBox='0 0 24 24'%3E%3Crect width='24' height='24' rx='4' fill='%23071126'/%3E%3Cpath d='M6 16c.9-2.5 4-6 7-6s6.1 3.5 7 6' stroke='%233aa0ff' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round' fill='none'/%3E%3Ccircle cx='12' cy='8' r='3' fill='%23eaf6ff'/%3E%3C/svg%3E">
  <!-- Prism.js for syntax highlighting -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-okaidia.min.css" rel="stylesheet" />
  <!-- bootstrap -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <!-- stylesheet -->
  <link rel="stylesheet" href="css/styles.css">
  <!-- fontawesome -->
  <script src="https://kit.fontawesome.com/b3aed9cb07.js" crossorigin="anonymous"></script>
  
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest"></script>

</head>

<body onload="init()">

 
  <header class="site-header">
    <h1 class="welcome">Digit Recognition â€” Live Demo</h1>
    <section id="title">
      <h2 class="heading">Digit Recognition Model</h2>
      <p class="lead">A client-side demo using a convolutional neural network trained on the MNIST dataset & SVM vectors. The model was trained in Keras, exported to TensorFlow.js format, and runs directly in your browser for instant predictions.</p>
    </section>
  </header>

  

  

  <section id="content">
    <div id="sketchpadapp">

      <div class="row">
        <div class="leftside">

          <div class="">
            <canvas id="sketchpad" height="200" width="200">
            </canvas>
          </div>

          <div class="buttons_div">
            <button type="button" class="btn btn-dark" id="predict_button">Predict</button>
            <button type="button" class="btn btn-dark" id="clear_button">&nbsp Clear &nbsp</button>
          </div>
        </div>

        <div class="predicted_answer col-sm-6">
          <h2 id="prediction_heading">Prediction</h2>
          <h1 id="result">-</h1>
          <p id="confidence">Confidence: -</p>
        </div>
      </div>
    </div>
  </section>  

  <!-- Model information summary -->
  <section id="model-info" class="model-info">
    <div class="container">
      <h3 class="model-info__title">Trained CNN Model Information</h3>
      <ul class="model-info__list">
        <li><strong>Model Type:</strong> Convolutional Neural Network</li>
        <li><strong>Dataset:</strong> MNIST Digits (0-9)</li>
        <li><strong>Architecture:</strong> Custom CNN with Conv2D, MaxPooling2D, BatchNormalization and Dropout layers</li>
        <li><strong>Accuracy:</strong> ~99% on test set</li>
      </ul>
    </div>
  </section>


  <footer id="footer">
    <p class="sr-only">Author links removed for privacy.</p>
  </footer>

  <!-- How This Works: Training / Preprocessing / Prediction -->
  <section id="how-this-works" class="how-this-works">
    <div class="container">
      <h3 class="how-title">How This Works</h3>
      <p class="how-intro">This implementation demonstrates a complete CNN-based handwriting recognition system:</p>

      <div class="tabs">
        <button class="tab active">Training</button>
        <button class="tab">Preprocessing</button>
        <button class="tab">Prediction</button>
      </div>

      <div class="code-panels">
        <div class="code-panel" id="panel-training">
          <h4>Model Training Process</h4>
          <pre><code class="language-python">// CNN Model Architecture
model = Sequential([
  Conv2D(32, kernel_size=3, activation='relu', input_shape=(28, 28, 1)),
  MaxPooling2D(),
  Conv2D(32, kernel_size=3, activation='relu'),
  BatchNormalization(),
  Conv2D(32, kernel_size=5, strides=2, padding='same', activation='relu'),
  BatchNormalization(),
  Dropout(0.4),
  Conv2D(64, kernel_size=3, activation='relu'),
  BatchNormalization(),
  Conv2D(64, kernel_size=3, activation='relu'),
  BatchNormalization(),
  Conv2D(64, kernel_size=5, strides=2, padding='same', activation='relu'),
  BatchNormalization(),
  Dropout(0.4),
  Flatten(),
  Dropout(0.4),
  Dense(10, activation='softmax')
])

// Compile and train
model.compile(loss='categorical_crossentropy', optimizer='adam', metrics=['accuracy'])
model.fit(x_train, y_train, batch_size=128, epochs=30, validation_data=(x_test, y_test))</code></pre>
          <p class="caption">The CNN model was trained on the MNIST dataset of handwritten digits and achieved over 99% accuracy on the test set.</p>
        </div>

        <div class="code-panel" id="panel-preprocessing">
          <h4>Image Preprocessing</h4>
          <pre><code class="language-javascript">// JavaScript preprocessing function
function preprocessCanvasData(canvas) {
  // Create temporary canvas for resizing
  const tempCanvas = document.createElement('canvas');
  const tempCtx = tempCanvas.getContext('2d');
  tempCanvas.width = 28;
  tempCanvas.height = 28;

  // Draw and resize to 28x28
  tempCtx.drawImage(canvas, 0, 0, 28, 28);

  // Get resized image data
  const imageData = tempCtx.getImageData(0, 0, 28, 28);
  const data = imageData.data;

  // Convert to grayscale and normalize
  const grayscale = [];
  for (let i = 0; i < data.length; i += 4) {
    // Convert to grayscale using luminance formula
    const gray = 0.299 * data[i] + 0.587 * data[i + 1] + 0.114 * data[i + 2];
    grayscale.push((255 - gray) / 255);
  }

  // Reshape to match model input: [1, 28, 28, 1]
  const reshaped = [];
  for (let i = 0; i < 28; i++) {
    const row = [];
    for (let j = 0; j < 28; j++) {
      row.push([grayscale[i * 28 + j]]);
    }
    reshaped.push(row);
  }
  return reshaped;
}</code></pre>
        </div>

        <div class="code-panel" id="panel-prediction">
          <h4>Prediction Process</h4>
          <pre><code class="language-javascript">// Using TensorFlow.js for prediction
async function predictDigit(imageData) {
  // Convert to tensor
  const tensor = tf.tensor4d(imageData, [1, 28, 28, 1]);

  // Make prediction
  const prediction = model.predict(tensor);

  // Get probabilities
  const probabilities = await prediction.data();

  // Find the digit with highest probability
  let maxProb = -1;
  let predictedDigit = -1;
  for (let i = 0; i < probabilities.length; i++) {
    if (probabilities[i] > maxProb) {
      maxProb = probabilities[i];
      predictedDigit = i;
    }
  }

  // Clean up tensor memory
  tensor.dispose();
  prediction.dispose();

  return { digit: predictedDigit, confidence: maxProb };
}</code></pre>
        </div>
      </div>
    </div>
  </section>

  <script src="js/main.js" charset="utf-8"></script>
  <!-- Prism.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>

</body>

</html>